# Router

참조: https://minwan1.github.io/2018/10/01/2018-09-03-network-network-divice/

## 허브(L1 더미허브)

허브는 여러 대의 컴퓨터를 연결해서 네트워크를 만들어주는 장치입니다. 허브에는 장치를 연결할 수 있는 연결점인 포트가 있습니다. 포트 갯수는 허브에 따라 다양하며, 1개의 포트에 한 대의 장비가 할당됩니다. 

허브는 데이터 패킷을 받으면 연결된 모든 장치들에게 모두 보냅니다. 모든 장치들이 데이터 패킷을 받고 자신에게 온 데이터 패킷인지 확인하고 필요하면 취득합니다. 즉, 단순 분배를 하는 중계 장치입니다.

허브는 위와 같이 모든 연결된 장치들에게 패킷을 뿌리기 때문에, 자신이 가지고 있는 데이터 전송 대역을 분리해서 사용해야 됩니다. 예를 들어, 원래 허브의 데이터 전송속도가 500Mbps라고 하면, 장치 5대가 연결되어 있는 경우 대역폭은 100Mbps로 나눠지게 됩니다.

허브는 IP 할당 기능은 따로 있지 않고, 리피터(Repeater)와 멀티포트(Multi-Port)의 역할을 합니다.

리피터(Repeater) : 전송 거리가 짧아서 신호가 도달하지 못하는 경우에 설치하여 신호전달을 용이하게 합니다.
멀티포트(Multi-Port) : 공유기의 포트가 모자란 경우 설치하여 포트를 늘리는 것입니다.

허브로 연결된 네트워크에서는 한 컴퓨터에서 주고받는 데이터가 같은 허브에 연결된 다른 모든 컴퓨터에 전달됩니다. 따라서 연결된 컴퓨터의 개수가 많아질 수록 네트워크에서 충돌(collision)이 많아지고 속도가 느려지죠. 이 문제를 해결하기 위해 최근에는 데이터를 필요로 하는 컴퓨터에만 전송하는 이더넷 스위치 장비를 많이 사용합니다.

## 스위치(L2)(frame)

한 PC만이 데이터를 보낼 수 있다고 했다. 즉 허브에 연결된 한 PC에서 발생하는 콜리전이 허브에 연결된 모든 영역에 노드들에게 영향을 미쳐서 통신을 하지 못한다. 이러한 문제를 해결하기 위해서 콜리전 도메인을 나누어 줄 수 있는 장비가 나와있는데 이것이 브릿지, 스위치이다.

예를 들어 1,2번 사이에 통신이 일어나면 CSMA/CD라는 특징 때문에 나머지 모든 PC들은 기다려야만 하는 허브와는 달리 PC들도 동시에 통신이 가능하다. 이것이 위의 허브와 스위치의 가장 큰 차이다. 또한 스위치는 데이터의 전송 에러 등을 복구해주는 기능들을 가진다. 서버의 경우 사용자들이 많기 때문에 허브보다 스위치를 사용하는 것이 좋다.

스위치는 자신에게 연결된 디바이스들의 IP와 MAC 주소를 테이블로 모두 가지고 있다. 따라서 프레임이 자신에게 오면 그것의 목적지가 어디인지를 파악하여 그 디바이스에게 프레임을 보내준다. 트래픽이 훨씬 효율적이 되는 것이다. 다만 스위치는 자신의 테이블에 없는 목적지를 가진 패킷이 오면 그것을 무조건 모든 기계에 포워딩한다. 이런 경우는 허브와 똑같이 동작하는 것이다.


## 라우터(L3)(패킷)

라우터란 둘 혹은 그 이상의 네트워크와 네트워크 간 데이터 전송을 위해 최적 경로를 설정해주며 데이터를 해당 경로를 따라 한 통신망에서 다른 통신망으로 통신할 수 있도록 도와주는 인터넷 접속 장비이다. 네트워크를 통해 정보를 주고 받을 때 데이터에 담긴 수신처의 주소를 읽고 가장 적절한 통신통로를 이용해 다른 통신망으로 전송하는 장치로, 전화국의 교환기와 비슷한 개념이다.

내부 네트워크는 사용하는 컴퓨터 기종이나 OS, 프로토콜 등을 확실히 알 수 있기 때문에 네트워크의 최적화를 이룰 수 있다. 그러나 내부 네트워크를 외부와 연결할 때는 외부 네트워크에서 사용하는 프로토콜이나 컴퓨터 기종 등의 정보를 알 수 없다. 이러한 알 수 없는 임의의 네트워크와 내부 네트워크를 연결하기 위한 네트워크 장비가 바로 라우터이다.


라우터는 LAN(Local Area Network:근거리 통신망)을 연결해 주는 장치로써, 데이터를 전송할 때 최종 목적지에 가기 위하여 거쳐야하는 많은 경로들 중에 적절한 통신 경로를 결정하기 위하여 한 통신망에서 다른 통신망으로 데이터 패킷을 전송하는 장치입니다.

주로 Web에서 우리가 서비스를 사용하기 위해서는 구글, 네이버과 같은 서비스 제공자의 주소에 접속을 필요로 합니다. 이런 경우에 서버가 내 IP와는 다른 IP를 가지고 있는 경우가 많습니다. 이런 경우 먼저 우리가 흔히 알고 있는 ‘www.naver.com’와 같은 도메인을 통하여 접속을 하면, 도메인 서버를 통하여 IP를 얻을 수 있습니다. 이 IP를 이용하여 요청을 보내면, 라우터에서는 ‘다음은 여기 라우터로 가야됩니다!’ 라고 판단하고 데이터 패킷을 다른 라우터에게 전송해줍니다. 이런 과정을 여러번 진행하면서 수많은 라우터들을 거치고, 최종 목적지인 네이버로 도착하게 되는 것입니다.

위의 에제에서는 Web에서 비유했는데, 전화망에서도 라우터를 사용합니다. 전화망의 전화번호가 Web에서의 IP와 같은 번호라고 생각하면 될 것 같습니다. 많은 장치들을 한 번에 라우터에 연결할 수 없기 때문에, 라우터로 연결하기 전에 장치들을 백본 스위치에 연결하고 나서, 백본 스위치의 선을 라우터에 연결한다고 합니다.


## 공유기

ISP(Internet Service provider) 업체에서 제공하는 한 개의 인터넷 IP Address로 여러 대의 컴퓨터, 노트북, 폰 등이 인터넷을 공유할 수 있는 기능을 제공합니다. 주로 가정용으로 사용되는 소용량 라우터를 말한다. 공유기를 사용하면 ISP에서 할당받은 하나의 공인 IP Address를 내부 네트웍에서 여러 개의 IP 주소로 변환 사용가능하기 때문에, 한 대의 컴퓨터에서만 인터넷 접속이나 외부 네트워크와 연결되던 것을 최대 253대까지 동시에 인터넷을 접속할 수 있다. 사실상 라우터의 NAT(Network Address Translation) 기능만 가지고 있다고 해도 무방하다.

하나의 IP를 여러 디바이스가 공유해서 인터넷을 이용할 수 있게 하는 기기

공유기는 WAN과 LAN 사이의 중계자라고 할 수 있습니다.

LAN 내부에 연결된 디바이스도 각자 IP를 가지고 있는데 공유기 스스로도 LAN의 디바이스기 때문에 내부IP를 부여받습니다. 공유기에 부여된 특수한 IP는 Gateway address 혹은 Router address라고 합니다.

WAN에서의 공유기의 IP는 public IP address입니다.
