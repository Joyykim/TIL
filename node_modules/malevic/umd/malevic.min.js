/* malevic@0.18.0 - Feb 7, 2020 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Malevic={})}(this,function(t){"use strict";function h(t){return null!=t&&"object"==typeof t}function a(t){return h(t)&&Object.getPrototypeOf(t)===Object.prototype}function m(t,e){return void 0===e&&(e=0),t[t.length-1-e]}function c(t){return h(t)&&null!=t.type&&null==t.nodeType}function i(t){return c(t)&&"string"==typeof t.type}function o(t){return c(t)&&"function"==typeof t.type}function e(){var o=[];return{add:function(t){return o.push(t),this},apply:function(t){for(var e,n,r=new Set,i=o.length-1;0<=i;i--)if(n=o[i],!r.has(n)){if(null!=(e=n(t)))return e;r.add(n)}return null},delete:function(t){for(var e=o.length-1;0<=e;e--)if(o[e]===t){o.splice(e,1);break}return this},empty:function(){return 0===o.length}}}function n(r,t,i){t.filter(function(t){var e=t[0];return r[e]}).forEach(function(t){var e=t[0],n=t[1];return r[e].forEach(function(t){return i(n,t)})})}function u(t,e){n(t,e,function(t,e){return t.add(e)})}function s(t,e){n(t,e,function(t,e){return t.delete(e)})}function r(n){var r={add:function(t,e){return t[n]||(t[n]=[]),t[n].push(e),r}};return r}var l=Symbol(),p=e();function d(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=[];return t.filter(function(t){return Boolean(t)}).forEach(function(e){"string"==typeof e?n.push(e):"object"==typeof e&&n.push.apply(n,Object.keys(e).filter(function(t){return Boolean(e[t])}))}),n.join(" ")}function f(e){return Object.keys(e).filter(function(t){return null!=e[t]}).map(function(t){return t+": "+e[t]+";"}).join(" ")}function v(t,e,n){if(null!=n&&""!==n){var r=String(n),i="";r.endsWith("!important")&&(r=r.substring(0,r.length-10),i="important"),t.style.setProperty(e,r,i)}else t.style.removeProperty(e)}var y=new WeakMap;function g(e,t){var n=new Map,r=new Set(Object.keys(e));return Object.keys(t).filter(function(t){return!r.has(t)}).forEach(function(t){return n.set(t,null)}),r.forEach(function(t){return n.set(t,e[t])}),n}function E(t,e,n){var r,i,o,u;"function"==typeof n?(r=t,i=e,o=n,y.has(r)?u=y.get(r):(u=new Map,y.set(r,u)),u.get(i)!==o&&(u.has(i)&&r.removeEventListener(i,u.get(i)),r.addEventListener(i,o),u.set(i,o))):function(t,e){if(y.has(t)){var n=y.get(t);t.removeEventListener(e,n.get(e)),n.delete(e)}}(t,e)}var w=new Set(["key","oncreate","onupdate","onrender","onremove"]),b=Symbol(),x=e();function k(t,e){return t&&t.hasOwnProperty(e)?t[e]:null}function A(p,t,f){g(t,f||{}).forEach(function(t,e){var n,r,i,o,u,a,s;if(!x.empty()&&null!=x.apply({element:p,attr:e,value:t,get prev(){return k(f,e)}}))return;if("class"===e&&h(t))u=p,a=t,(s=Array.isArray(a)?d.apply(void 0,a):d(a))?u.setAttribute("class",s):u.removeAttribute("class");else if("style"===e&&h(t)){var c=k(f,e);n=p,r=t,h(i=c)?o=i:(o={},n.removeAttribute("style")),g(r,o).forEach(function(t,e){return v(n,e,t)})}else if(e.startsWith("on")){var l=e.substring(2);E(p,l,t)}else w.has(e)||(null==t||!1===t?p.removeAttribute(e):p.setAttribute(e,!0===t?"":String(t)))})}var N=(S.prototype.empty=function(){return null==this.first},S.prototype.push=function(t){this.empty()?this.first=t:(this.nexts.set(this.last,t),this.prevs.set(t,this.last)),this.last=t},S.prototype.insertBefore=function(t,e){var n=this.before(e);this.prevs.set(t,n),this.nexts.set(t,e),this.prevs.set(e,t),n&&this.nexts.set(n,t),e===this.first&&(this.first=t)},S.prototype.delete=function(t){var e=this.before(t),n=this.after(t);e&&this.nexts.set(e,n),n&&this.prevs.set(n,e),t===this.first&&(this.first=n),t===this.last&&(this.last=e)},S.prototype.before=function(t){return this.prevs.get(t)||null},S.prototype.after=function(t){return this.nexts.get(t)||null},S.prototype.loop=function(t){if(!this.empty()){var e=this.first;do{if(t(e))break}while(e=this.after(e))}},S.prototype.copy=function(){var e=new S;return this.loop(function(t){return e.push(t),!1}),e},S.prototype.forEach=function(e){this.loop(function(t){return e(t),!1})},S.prototype.find=function(e){var n=null;return this.loop(function(t){return!!e(t)&&(n=t,!0)}),n},S.prototype.map=function(e){var n=[];return this.loop(function(t){return n.push(e(t)),!1}),n},S);function S(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.nexts=new WeakMap,this.prevs=new WeakMap,this.first=null,this.last=null,t.forEach(function(t){return e.push(t)})}function M(t,e,n){var r=t&&e&&t.matches(e);r&&t.parent()===e.parent()?n.replaceVNode(e,t):t&&n.addVNode(t);var i=n.getVNodeContext(t),o=n.getVNodeContext(e);if((e&&!r&&(e.detach(o),e.children().forEach(function(t){return M(null,t,n)}),e.detached(o)),t&&!r&&(t.attach(i),t.children().forEach(function(t){return M(t,null,n)}),t.attached(i)),r)&&t.update(e,i)!==n.LEAVE){var u=function(t,e){var n=e.children(),i=new Map,o=[];n.forEach(function(t){var e=t.key();null==e?o.push(t):i.set(e,t)});var r=t.children(),u=[],a=new Set(n),s=new Set;return r.forEach(function(t){var e=null,n=null,r=t.key();if(null!=r){if(s.has(r))throw new Error("Duplicate key");s.add(r),i.has(r)&&(n=i.get(r))}else 0<o.length&&(n=o.shift());t.matches(n)&&(e=n),u.push([t,e]),e&&a.delete(e)}),{matches:u,unmatched:a}}(t,e),a=u.matches;u.unmatched.forEach(function(t){return M(null,t,n)}),a.forEach(function(t){return M(t[0],t[1],n)}),t.updated(i)}}var C=function(t,e){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function O(t,e){function n(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var V=function(){return(V=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function _(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],u=0,a=o.length;u<a;u++,i++)r[i]=o[u];return r}var j=(D.prototype.key=function(){return null},D.prototype.parent=function(t){if(!t)return this.parentVNode;this.parentVNode=t},D.prototype.children=function(){return[]},D.prototype.attach=function(t){},D.prototype.detach=function(t){},D.prototype.update=function(t,e){return null},D.prototype.attached=function(t){},D.prototype.detached=function(t){},D.prototype.updated=function(t){},D);function D(t){this.parentVNode=t}function P(t,e){return t instanceof Element&&e.type===t.tagName.toLowerCase()}var R=new WeakMap;function T(t,e){var n;R.has(e)?n=R.get(e):(n=new WeakSet,R.set(e,n)),n.add(t)}function W(t,e){return R.has(e)&&R.get(e).has(t)}var $,L=(O(U,$=j),U.prototype.matches=function(t){return t instanceof U&&this.spec.type===t.spec.type},U.prototype.key=function(){return this.spec.props.key},U.prototype.children=function(){return[this.child]},U.prototype.getExistingElement=function(t){var e,n=t.parent,r=t.node;if(P(r,this.spec))e=r;else if(!W(n,t.vdom)&&t.vdom.isDOMNodeCaptured(n)){var i=t.sibling,o=i?i.nextElementSibling:n.firstElementChild;o&&!t.vdom.isDOMNodeCaptured(o)&&(P(o,this.spec)?e=o:n.removeChild(o))}return e},U.prototype.attach=function(t){var e,n=this.getExistingElement(t);n?e=n:T(e=function(t,e){var n=p.apply({spec:t,parent:e});if(n)return n;var r=t.type;return"svg"===r?document.createElementNS("http://www.w3.org/2000/svg","svg"):"http://www.w3.org/1999/xhtml"===e.namespaceURI?document.createElement(r):document.createElementNS(e.namespaceURI,r)}(this.spec,t.parent),t.vdom),A(e,this.spec.props,null),this.child=ut(e,this.spec.children,this)},U.prototype.update=function(t,e){var n=e.vdom.getVNodeContext(t).node;A(n,this.spec.props,t.spec.props),this.child=ut(n,this.spec.children,this)},U.prototype.attached=function(t){var e=this.spec.props,n=e.oncreate,r=e.onrender;n&&n(t.node),r&&r(t.node)},U.prototype.detached=function(t){var e=this.spec.props.onremove;e&&e(t.node)},U.prototype.updated=function(t){var e=this.spec.props,n=e.onupdate,r=e.onrender;n&&n(t.node),r&&r(t.node)},U);function U(t,e){var n=$.call(this,e)||this;return n.spec=t,n}var z,F={CREATED:Symbol(),REMOVED:Symbol(),UPDATED:Symbol(),RENDERED:Symbol()},I=[[l,p],[b,x]],B=(O(q,z=j),q.prototype.matches=function(t){return t instanceof q&&this.spec.type===t.spec.type},q.prototype.key=function(){return this.spec.props.key},q.prototype.children=function(){return[this.child]},q.prototype.createContext=function(r){var i=this,t=r.parent,e=this.spec,n=this.prev,o=this.store;return{spec:e,prev:n,store:o,get node(){return r.node},get nodes(){return r.nodes},parent:t,onCreate:function(t){return o[F.CREATED]=t},onUpdate:function(t){return o[F.UPDATED]=t},onRemove:function(t){return o[F.REMOVED]=t},onRender:function(t){return o[F.RENDERED]=t},refresh:function(){if(i.lock)throw new Error("Calling refresh during unboxing causes infinite loop");i.prev=i.spec;var t=r.vdom.getVNodeContext(i),e=i.unbox(t);if(e!==r.vdom.LEAVE){var n=i.child;i.child=lt(e,i),r.vdom.execute(i.child,n),i.updated(r)}},leave:function(){return r.vdom.LEAVE}}},q.prototype.unbox=function(t){var e=this.spec.type,n=this.spec.props,r=this.spec.children;this.lock=!0;var i=q.context;q.context=this.createContext(t);var o=null;try{o=e.apply(void 0,_([n],r))}finally{q.context=i,this.lock=!1}return o},q.prototype.addPlugins=function(){u(this.spec.type,I)},q.prototype.deletePlugins=function(){s(this.spec.type,I)},q.prototype.attach=function(t){this.addPlugins();var e=this.unbox(t),n=e===t.vdom.LEAVE?null:e;this.child=lt(n,this)},q.prototype.update=function(t,e){this.store=t.store,this.prev=t.spec;var n=e.vdom.getVNodeContext(t);this.addPlugins();var r=this.unbox(n),i=null;return r===e.vdom.LEAVE?(i=r,this.child=t.child,e.vdom.adoptVNode(this.child,this)):this.child=lt(r,this),i},q.prototype.handle=function(t,e){var n=this.store[t];if(n){var r=0===e.nodes.length?[null]:e.nodes;n.apply(void 0,r)}},q.prototype.attached=function(t){this.deletePlugins(),this.handle(F.CREATED,t),this.handle(F.RENDERED,t)},q.prototype.detached=function(t){this.handle(F.REMOVED,t)},q.prototype.updated=function(t){this.deletePlugins(),this.handle(F.UPDATED,t),this.handle(F.RENDERED,t)},q.context=null,q);function q(t,e){var n=z.call(this,e)||this;return n.lock=!1,n.spec=t,n.prev=null,n.store={},n}function H(){return B.context}var G,J=(O(K,G=j),K.prototype.matches=function(t){return t instanceof K},K.prototype.children=function(){return[this.child]},K.prototype.getExistingNode=function(t){var e,n=t.parent;if(t.node instanceof Text)e=t.node;else if(!W(n,t.vdom)&&t.vdom.isDOMNodeCaptured(n)){var r=t.sibling,i=r?r.nextSibling:n.firstChild;i&&!t.vdom.isDOMNodeCaptured(i)&&i instanceof Text&&(e=i)}return e},K.prototype.attach=function(t){var e,n=this.getExistingNode(t);n?(e=n).textContent=this.text:e=document.createTextNode(this.text),this.child=lt(e,this)},K.prototype.update=function(t,e){var n=e.vdom.getVNodeContext(t).node;this.text!==t.text&&(n.textContent=this.text),this.child=lt(n,this)},K);function K(t,e){var n=G.call(this,e)||this;return n.text=t,n}var Q,X=(O(Y,Q=j),Y.prototype.matches=function(t){return t instanceof Y},Y.prototype.children=function(){return[this.child]},Y.prototype.call=function(t){var e=(0,this.fn)({parent:t.parent,get node(){return t.node},get nodes(){return t.nodes}});this.child=lt(e,this)},Y.prototype.attach=function(t){this.call(t)},Y.prototype.update=function(t,e){var n=e.vdom.getVNodeContext(t);this.call(n)},Y);function Y(t,e){var n=Q.call(this,e)||this;return n.fn=t,n}var Z,tt=(O(et,Z=j),et.prototype.matches=function(t){return t instanceof et},et);function et(){return null!==Z&&Z.apply(this,arguments)||this}var nt,rt=(O(it,nt=j),it.prototype.matches=function(t){return t instanceof it&&this.node===t.node},it.prototype.wrap=function(){var e=this;this.childVNodes=this.childSpecs.map(function(t){return lt(t,e)})},it.prototype.insertNode=function(t){var e=t.parent,n=t.sibling;if(e!==this.node.parentElement||n!==this.node.previousSibling){var r=n?n.nextSibling:e.firstChild;e.insertBefore(this.node,r)}},it.prototype.attach=function(t){this.wrap(),this.insertNode(t)},it.prototype.detach=function(t){t.parent.removeChild(this.node)},it.prototype.update=function(t,e){this.wrap(),this.insertNode(e)},it.prototype.refine=function(t){for(var e=this.node,n=e.lastChild;null!=n;)if(t.vdom.isDOMNodeCaptured(n))n=n.previousSibling;else{var r=n.previousSibling;e.removeChild(n),n=r}T(e,t.vdom)},it.prototype.attached=function(t){var e=this.node;e instanceof Element&&!W(e,t.vdom)&&t.vdom.isDOMNodeCaptured(e)&&this.refine(t)},it.prototype.children=function(){return this.childVNodes},it);function it(t,e,n){var r=nt.call(this,n)||this;return r.node=t,r.childSpecs=e,r}function ot(t){return t instanceof rt}function ut(t,e,n){return new rt(t,e,n)}var at,st=(O(ct,at=j),ct.prototype.matches=function(t){return t instanceof ct},ct.prototype.key=function(){return this.id},ct.prototype.children=function(){return this.childVNodes},ct.prototype.wrap=function(){var e=this;this.childVNodes=this.items.map(function(t){return lt(t,e)})},ct.prototype.attach=function(){this.wrap()},ct.prototype.update=function(){this.wrap()},ct);function ct(t,e,n){var r=at.call(this,n)||this;return r.items=t,r.id=e,r}function lt(t,e){if(i(t))return new L(t,e);if(o(t))return t.type===Array?new st(t.children,t.props.key,e):new B(t,e);if("string"==typeof t)return new J(t,e);if(null==t)return new tt(e);if("function"==typeof t)return new X(t,e);if(t instanceof Node)return ut(t,[],e);if(Array.isArray(t))return new st(t,null,e);throw new Error("Unable to create virtual node for spec")}function pt(i){var u=new WeakMap,a=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakSet;function p(n){var r=s.get(n);u.set(n,{parent:r,get node(){var t=c.get(n).find(function(t){return null!=t.node});return t?t.node:null},get nodes(){return c.get(n).map(function(t){return t.node}).filter(function(t){return t})},get sibling(){if(r===i.parentElement)return c.get(n).first.node.previousSibling;for(var t=a.get(r),e=c.get(n).first;e=t.links.before(e);)if(e.node)return e.node;return null},vdom:o})}function f(t){var e,n,r;null==t.parent()?(e=t,n=i.parentElement||document.createDocumentFragment(),r=new N({parentNode:n,node:i}),c.set(e,r.copy()),s.set(e,n),a.set(n,{node:n,links:r})):function(t){var e=t.parent(),n=l.has(e),r=ot(e)?e.node:s.get(e);s.set(t,r);var i=new N;if(c.set(t,i),n){for(var o={parentNode:r,node:null},u=t;c.get(u).push(o),(u=u.parent())&&!ot(u););a.get(r).links.push(o)}else{l.add(e),(ot(e)?a.get(r).links:c.get(e)).forEach(function(t){return i.push(t)})}}(t),function(t){if(ot(t)){var e=t.node;a.set(e,{node:e,links:new N({parentNode:e,node:null})}),c.get(t).forEach(function(t){return t.node=e})}}(t),p(t)}function h(t){for(var e=s.get(t),n=a.get(e),r=[],i=t;(i=i.parent())&&!ot(i);)r.push(c.get(i));return r.push(n.links),r}var o={execute:function(t,e){M(t,e,o)},addVNode:f,getVNodeContext:function(t){return u.get(t)},replaceVNode:function(t,e){if(null!=e.parent()){var n=u.get(t).parent;s.set(e,n);var r=c.get(t),i={parentNode:n,node:null};h(e).forEach(function(e){var t=e.after(r.last);r.forEach(function(t){return e.delete(t)}),t?e.insertBefore(i,t):e.push(i)});var o=new N(i);c.set(e,o),p(e)}else f(e)},adoptVNode:function(t,e){var n=c.get(t),r=c.get(e).copy();t.parent(e),h(t).forEach(function(e){n.forEach(function(t){return e.insertBefore(t,r.first)}),r.forEach(function(t){return e.delete(t)})})},isDOMNodeCaptured:function(t){return a.has(t)&&t!==i.parentElement},LEAVE:Symbol()};return o}var ft=new WeakMap,ht=new WeakMap;function dt(t,e){var n,r=ft.get(t)||null;return ft.set(t,e),ht.has(t)?n=ht.get(t):(n=pt(t),ht.set(t,n)),n.execute(e,r),n.getVNodeContext(e)}var vt={createElement:r(l),setAttribute:r(b)},yt=Object.freeze({__proto__:null,plugins:vt,render:function(t,e){return dt(t,ut(t,Array.isArray(e)?e:[e],null)),t},sync:function(t,e){var n=dt(t,lt(e,null)).nodes;if(1!==n.length||n[0]!==t)throw new Error("Spec does not match the node");return n[0]},teardown:function(t){ft.delete(t),ht.delete(t)},getContext:H});function mt(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var gt=Symbol(),Et=e();var wt=Symbol(),bt=e(),xt=new Set(["key","oncreate","onupdate","onrender","onremove"]);var kt=Symbol(),At=e();var Nt=new Set(["area","base","br","col","embed","hr","img","input","link","menuitem","meta","param","source","track","wbr"]),St=null;function Mt(){}var Ct=[[gt,Et],[wt,bt],[kt,At]];function Ot(t,e){return"".padEnd(t.length*e,t)}var Vt,_t=(O(jt,Vt=Mt),jt.prototype.stringify=function(t){var e=t.indent,n=t.depth,r=[],i=Ot(e,n),o=Array.from(this.attrs.entries()).map(function(t){var e=t[0],n=t[1];return""===n?e:e+'="'+n+'"'}).join(" "),u=i+"<"+this.tag+(o?" "+o:"")+">";if(this.isVoid)r.push(u);else{var a="</"+this.tag+">";0===this.children.length?r.push(u+a):1===this.children.length&&this.children[0]instanceof Pt&&!this.children[0].text.includes("\n")?r.push(u+this.children[0].stringify({indent:e,depth:0})+a):(r.push(u),this.children.forEach(function(t){return r.push(t.stringify({indent:e,depth:n+1}))}),r.push(i+a))}return r.join("\n")},jt);function jt(t){var r=Vt.call(this)||this;return r.children=[],r.tag=t.type,r.attrs=new Map,Object.entries(t.props).filter(function(t){return!function(t,e){if(!bt.empty()){var n=bt.apply({attr:t,value:e});if(null!=n)return n}return xt.has(t)||t.startsWith("on")||null==e||!1===e}(t[0],t[1])}).forEach(function(t){var e=t[0],n=t[1];return r.attrs.set(e,function(t,e){if(!Et.empty()){var n=Et.apply({attr:t,value:e});if(null!=n)return n}return"class"===t&&h(e)?mt(Array.isArray(e)?d.apply(void 0,e):d(e)):"style"===t&&h(e)?mt(f(e)):!0===e?"":mt(String(e))}(e,n))}),r.isVoid=function(t){if(!At.empty()){var e=At.apply(t);if(null!=e)return e}return Nt.has(t)}(r.tag),r}var Dt,Pt=(O(Rt,Dt=Mt),Rt.prototype.stringify=function(t){var e=Ot(t.indent,t.depth);return""+e+this.text.replace(/\n/g,"\n"+e)},Rt);function Rt(t){var e=Dt.call(this)||this;return e.text=mt(t),e}var Tt,Wt=(O($t,Tt=Mt),$t.prototype.stringify=function(t){return Ot(t.indent,t.depth)+"\x3c!--"+this.text+"--\x3e"},$t);function $t(t){var e=Tt.call(this)||this;return e.text=mt(t),e}function Lt(t,e){if(i(t)){var n=new _t(t);e.children.push(n),t.children.forEach(function(t){return Lt(t,n)})}else if(o(t)){if(t.type===Array)t.children.forEach(function(t){return Lt(t,e)});else u(t.type,Ct),Lt(function(t){var e=t.type,n=t.props,r=t.children,i=St;St={};var o=e.apply(void 0,_([n],r));return St=i,o}(t),e),s(t.type,Ct)}else if("string"==typeof t){var r=new Pt(t);e.children.push(r)}else if(null==t){r=new Wt("");e.children.push(r)}else{if(!Array.isArray(t))throw new Error("Unable to stringify spec");t.forEach(function(t){return Lt(t,e)})}}var Ut={stringifyAttribute:r(gt),skipAttribute:r(wt),isVoidTag:r(kt)};var zt=Object.freeze({__proto__:null,stringify:function(t,e){var n,r,i=void 0===e?{}:e,o=i.indent,u=void 0===o?"    ":o,a=i.depth,s=void 0===a?0:a;if(c(t))return(n=t,r=new _t({type:"div",props:{},children:[]}),Lt(n,r),r.children).map(function(t){return t.stringify({indent:u,depth:s})}).join("\n");throw new Error("Not a spec")},plugins:Ut,isStringifying:function(){return null!=St},escapeHTML:mt});function Ft(t,e,n){return e*(1-t)+n*t}function It(e,n){return function(t){return Ft(t,e,n)}}function Bt(t){for(var e,n=[],r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[e][-+]?\d+)?/gim;e=r.exec(t);)n.push({index:e.index,length:e[0].length});return n}function qt(i,o){var u=Bt(i),a=Bt(o);return function(t){for(var e="",n=0,r=0;r<a.length;r++)e+=o.substring(n,a[r].index),e+=Ft(t,parseFloat(i.substr(u[r].index,u[r].length)),parseFloat(o.substr(a[r].index,a[r].length))).toString(),n=a[r].index+a[r].length;return e+=o.substring(n)}}function Ht(t){return t}var Gt={delay:0,duration:250,easing:"ease"},Jt=(Kt.prototype.initial=function(t){return this.$spec.initial=t,this},Kt.prototype.from=function(t){if(0<this.$spec.timeline.length)throw new Error("Starting keyframe was already declared");return this.$spec.timeline.push({from:t,to:null,timing:V({},Gt)}),this},Kt.prototype.to=function(t,e){this.$spec.interpolate||("number"==typeof t?this.$spec.interpolate=It:"string"==typeof t&&(this.$spec.interpolate=qt));var n=m(this.$spec.timeline);return n&&null==n.to?(n.to=t,e&&(n.timing=V(V({},n.timing),e))):this.$spec.timeline.push({from:n?n.to:null,to:t,timing:V(V({},Gt),e||{})}),this},Kt.prototype.interpolate=function(t){return this.$spec.interpolate=t,this},Kt.prototype.output=function(t){return this.$spec.output=t,this},Kt.prototype.done=function(t){return this.$spec.done=t,this},Kt.prototype.spec=function(){return this.$spec},Kt);function Kt(){this.$spec={initial:null,timeline:[],interpolate:null,output:Ht,done:null}}var Qt={linear:function(t){return t},ease:function(t){var e=(1-Math.cos(t*Math.PI))/2,n=Math.sqrt(1-Math.pow(t-1,2)),r=Math.sin(t*Math.PI/2);return e*(1-r)+n*r},"ease-in":function(t){var e=1-Math.cos(t*Math.PI/2);return 1-1e-15<e?1:e},"ease-out":function(t){return Math.sin(t*Math.PI/2)},"ease-in-out":function(t){return(1-Math.cos(t*Math.PI))/2}},Xt=(Yt.prototype.tick=function(t){null==this.startTime&&(this.startTime=t);for(var e,n=t-this.startTime,r=this.timeline,i=r.length-1;0<=i;i--){var o=r[i],u=o.standby,a=o.end;if(a<=n||u<=n&&n<=a){e=r[i];break}}var s=e.start,c=e.end,l=e.spec;e===m(r)&&c<=n&&(this.isComplete=!0),e.interpolate||(e.interpolate=this.interpolate(l.from,l.to));var p,f,h,d=("string"==typeof l.timing.easing?Qt[l.timing.easing]:l.timing.easing)(n<s?0:s===c?1:(p=(n-s)/(c-s),f=0,h=1,Math.min(h,Math.max(f,p)))),v=e.interpolate.call(null,d);this.lastValue=v;var y=this.output.call(null,v);this.callback.call(null,y)},Yt.prototype.value=function(){return this.lastValue},Yt.prototype.complete=function(){return this.isComplete},Yt.prototype.finalize=function(){this.doneCallback&&this.doneCallback.call(null)},Yt);function Yt(t,e){if(!t.interpolate)throw new Error("No interpolator provided");this.interpolate=t.interpolate,this.output=t.output,this.callback=e,this.doneCallback=t.done;var r=0;this.timeline=t.timeline.map(function(t){var e=r+t.timing.delay,n=e+t.timing.duration;return{standby:r,start:e,end:r=n,spec:t,interpolate:null}}),this.isComplete=!1}var Zt,te,ee,ne,re=(te=Zt=null,ee=!1,ne=[],{run:function(){ee=!0,Zt=performance.now(),te=requestAnimationFrame(ie)},stop:function(){cancelAnimationFrame(te),Zt=te=null,ee=!1},tick:function(t){ne.push(t)},time:function(){return Zt},running:function(){return ee}});function ie(){Zt=performance.now(),ne.forEach(function(t){return t(Zt)}),ee&&(te=requestAnimationFrame(ie))}function oe(t,e){t.tick(e),t.complete()&&(se(t),t.finalize())}re.tick(function(e){return Array.from(ae.values()).forEach(function(t){return oe(t,e)})});var ue=new WeakMap,ae=new Set;function se(t){ae.delete(t),0===ae.size&&re.stop()}function ce(t){var e=ue.get(t);return e&&ae.has(e)?e:null}function le(t){return a(t)&&Object.values(t).some(function(t){return t instanceof Jt})}function pe(t,e,n){var r,i,o,u,a,s=t.spec(),c=s.timeline[0].from,l=m(s.timeline).to;if(e instanceof Jt){var p=ce(e);if(p)se(p),r=p.value();else r=m(e.spec().timeline).to}else typeof e==typeof l&&null!=e&&null!=l&&e.constructor===l.constructor&&(r=e);(null!=c?i=c:null!=r?i=r:null!=s.initial&&(i=s.initial),null==i)?n(s.output(l)):(s.timeline[0].from=i,u=n,a=new Xt((o=t).spec(),u),ae.add(a),ue.set(o,a),re.running()||re.run(),oe(a,re.time()))}function fe(t){if(t instanceof Jt){var e=ce(t);e&&se(e)}}function he(t){var e=t.element,n=t.attr,r=t.value,i=t.prev;return r instanceof Jt?(pe(r,i,function(t){return e.setAttribute(n,t)}),!0):(le(i)?Object.values(i).forEach(function(t){return fe(t)}):fe(i),null)}function de(t){var i=t.element,e=t.attr,n=t.value,r=t.prev;if("style"===e){if(le(n)){var o,u=n;return a(r)?(o=r,Object.keys(o).filter(function(t){return!u.hasOwnProperty(t)}).forEach(function(t){fe(o[t]),v(i,t,null)})):(o={},i.removeAttribute("style"),fe(r)),Object.entries(u).forEach(function(t){var e=t[0],n=t[1],r=o[e];n instanceof Jt?pe(n,r,function(t){v(i,e,t)}):(fe(r),v(i,e,n))}),!0}le(r)&&Object.values(r).forEach(function(t){return fe(t)})}return null}function ve(t){return t.output(null!=t.timeline[0].from?t.timeline[0].from:null!=t.initial?t.initial:m(t.timeline).to)}function ye(t){var e=t.value;if(e instanceof Jt){var n=e.spec();return mt(String(ve(n)))}return null}function me(t){var e=t.attr,r=t.value;if("style"===e&&le(r)){var i={};return Object.keys(r).forEach(function(t){var e=r[t];if(e instanceof Jt){var n=e.spec();i[t]=ve(n)}else i[t]=e}),mt(f(i))}return null}var ge=Object.freeze({__proto__:null,animate:function(t,e){var n=new Jt;return null!=t&&n.to(t,e),n},withAnimation:function(t){if(yt){var e=vt;e.setAttribute.add(t,he),e.setAttribute.add(t,de)}if(zt){var n=Ut;n.stringifyAttribute.add(t,ye),n.stringifyAttribute.add(t,me)}return t}}),Ee=[],we=null;function be(e,t){if(null!=t)if(o(t))t.type===Array?t.children.forEach(function(t){return be(e,t)}):function(t,e){var n=e.type,r=e.props,i=e.children;u(n,Ee);var o=we;be(we=t,n.apply(void 0,_([r],i))),we=o,s(n,Ee)}(e,t);else if(Array.isArray(t))t.forEach(function(t){return be(e,t)});else{if("function"!=typeof t)throw new Error("Unable to draw spec");t(e)}}var xe=Object.freeze({__proto__:null,draw:be,getContext:function(){return we}});var ke=Object.freeze({__proto__:null,withForms:function(t){return vt.setAttribute.add(t,function(t){var e=t.element,n=t.attr,r=t.value;if("value"===n&&e instanceof HTMLInputElement){var i=e.value=null==r?"":r;return e.value=i,!0}return null}),t}}),Ae=null;var Ne=Object.freeze({__proto__:null,useState:function(t){if(!Ae)throw new Error("`useState()` should be called inside a component");return Ae(t)},withState:function(a){return function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=H(),o=!0,u=Ae;Ae=function(t){if(!i)return{state:t,setState:null};var e=i.store,n=i.refresh;e.state=e.state||t;return{state:e.state,setState:function(t){if(o)throw new Error("Setting state during unboxing causes infinite loop");e.state=V(V({},e.state),t),n()}}};try{r=a.apply(void 0,_([t],e))}finally{Ae=u,o=!1}return r}}});t.Animation=ge,t.Canvas=xe,t.DOM=yt,t.Forms=ke,t.State=Ne,t.String=zt,t.m=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(e=e||{},"string"==typeof t)return{type:t,props:e,children:n};if("function"!=typeof t)throw new Error("Unsupported spec type");return{type:t,props:e,children:n}},Object.defineProperty(t,"__esModule",{value:!0})});
